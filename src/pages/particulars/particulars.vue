<template>
  <div class="Fatherbox">
    <div class="main">
      <router-view></router-view>
    </div>
    <div class="footer">
      <div class="content">
        <div class="btn-collect" @click="collectInfo()">
          <span v-if="show">
            <svg
              t="1574755822407"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="2193"
              width="19"
              height="19"
            >
              <path
                d="M707.584 93.184c-77.312 0-148.992 38.912-196.608 102.912-47.104-64-119.296-102.912-196.608-102.912-139.264 0-252.416 123.904-252.416 275.968 0 90.624 40.448 154.624 73.216 205.824C229.888 723.968 468.48 908.8 478.72 916.48c9.728 7.68 20.992 11.264 32.256 11.264s22.528-3.584 32.256-11.264c10.24-7.68 248.32-193.024 343.552-341.504 32.768-51.2 73.216-115.2 73.216-205.824 0-152.064-113.152-275.968-252.416-275.968z"
                fill="#cb0e0e"
                p-id="2194"
              />
            </svg>
          </span>
          <span v-else>
            <svg
              t="1574755915924"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="2368"
              width="19"
              height="19"
            >
              <path
                d="M720.62293333 65.26293333c-82.46613333 0-158.9248 41.50613333-209.7152 109.7728-50.24426667-68.26666667-127.24906667-109.7728-209.7152-109.7728-148.54826667 0-269.24373333 132.16426667-269.24373333 294.36586667 0 96.6656 43.14453333 164.93226667 78.09706667 219.5456C211.08053333 738.0992 465.57866667 935.25333333 476.50133333 943.44533333c10.37653333 8.192 22.39146667 12.01493333 34.4064 12.01493334s24.02986667-3.82293333 34.4064-12.01493334c10.92266667-8.192 264.87466667-205.89226667 366.45546667-364.27093333 34.95253333-54.61333333 78.09706667-122.88 78.09706667-219.5456 0-162.2016-120.69546667-294.36586667-269.24373334-294.36586667zM842.41066667 577.536c-93.3888 131.072-291.08906667 280.71253333-300.91946667 287.81226667-9.28426667 7.09973333-20.20693333 10.92266667-30.58346667 10.92266666-10.92266667 0-21.2992-3.2768-30.58346666-10.92266666-9.8304-7.09973333-203.70773333-158.37866667-300.91946667-293.2736-31.1296-49.152-80.82773333-110.31893333-80.82773333-196.608 0-145.27146667 80.82773333-247.3984 213.53813333-247.3984 73.728 0 154.0096 70.4512 198.79253333 131.61813333 45.32906667-61.16693333 125.06453333-131.61813333 198.79253334-131.61813333 133.25653333 0 219.5456 102.12693333 219.5456 247.3984 0 86.28906667-55.15946667 153.46346667-86.8352 202.06933333z"
                fill="#212121"
                p-id="2369"
              />
            </svg>
          </span>
          <p>收藏</p>
        </div>
        <div class="btn-service" @click="showPopup">
          <svg
            t="1574516318937"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="9578"
            width="19"
            height="19"
          >
            <path
              d="M72.617283 687.788503c3.997164 9.9613-0.847117 21.250172-10.770486 25.249142a19.44034 19.44034 0 0 1-25.269011-10.82648A504.822084 504.822084 0 0 1 9.229818 609.019272a512.370275 512.370275 0 0 1-9.227976-97.019272c0-141.345704 57.305925-269.345253 149.997496-362.018761C242.616853 57.309537 370.654332 0 512.001842 0c141.343898 0 269.345253 57.309537 361.998893 149.981239 92.69157 92.673508 149.997495 220.673057 149.997495 362.018761 0 141.365572-57.305925 269.365121-149.997495 362.018761-92.65364 92.673508-220.654994 149.981239-361.998893 149.981239-50.193033 0-104.923289-7.846217-156.653414-23.500721-47.88649-14.518392-93.423089-35.826363-130.654691-63.923913-8.57593-6.460847-10.308094-18.652828-3.805704-27.230565 6.459041-8.577736 18.651022-10.270164 27.230564-3.807511 33.344618 25.175087 74.65105 44.404099 118.497028 57.692456 48.038213 14.558129 98.848973 21.826356 145.386217 21.826356 130.613148 0 248.884398-52.960161 334.495589-138.576769 85.576872-85.59674 138.578576-203.864378 138.578576-334.481139 0-130.596892-53.001704-248.86453-138.578576-334.481139-85.61119-85.614803-203.884247-138.57677-334.495589-138.57677-130.614954 0-248.884398 52.960161-334.499201 138.57677-85.576872 85.614803-138.538839 203.884247-138.538839 334.481139 0 30.826748 2.886339 60.788316 8.424208 89.731176a469.501462 469.501462 0 0 0 25.229273 86.059133zM325.424791 969.614732h0.03793c-31.464343 0-60.271737-7.365763-85.732207-21.904023-27.192634-15.520844-48.383201-39.462283-66.346053-67.001711-2.38421-4.327702-2.653336-4.788288-5.037546-9.21172-27.114967-49.616849 3.345118-128.133209 77.497652-186.557183 40.424998-31.807525 85.118092-50.057566 122.615208-50.057566 27.886222 0 50.463966 10.230427 64.117179 28.922992 2.924269 1.921818 7.806481 4.403563 11.807257 4.403563 1.154174 0 3.538384 0 7.114698-4.058575 0.22939-0.22939 0.462392-0.480454 0.691782-0.729713 20.885316-27.096904 40.191995-56.251093 57.425135-86.691309 15.808033-28.000014 29.806234-56.941069 41.613491-86.097063 1.654497-9.229781 0.422655-13.808548-0.652046-15.094576-0.729713-0.94104-3.001937-1.556961-3.001936-1.556961-20.460854-0.462392-38.727152-9.654243-53.231094-26.558651-27.344356-31.827393-38.960154-87.749754-31.115743-149.672376 12.079996-94.864452 64.156915-166.423255 121.076309-166.423255 0.155335 0 1.425107 0.019868 1.616567 0.019868 2.691267 0.057799 5.348216 0.326926 7.923885 0.731519 34.959378-1.57683 67.115503 5.711266 95.037849 21.692696 129.345182 73.885213 132.076186 306.114462 6.19172 528.69308-97.073459 171.74799-245.653072 287.150964-369.650037 287.150964z m43.034984-287.577232c-26.730242 0-61.651689 14.941047-93.461019 39.9608-55.422038 43.63465-79.883668 101.00018-67.38463 124.461164 1.921818 3.596183 3.271063 5.864795 4.307833 7.652952 12.462914 21.577098 31.079618 41.172773 51.195485 52.672972 18.228367 10.403824 39.189544 15.672566 62.307347 15.672566 105.882391 0 241.00025-108.22867 328.612731-263.211331 109.157067-193.01803 114.384266-405.767202 11.462269-464.556033-20.652313-11.787388-45.000152-16.980269-71.652726-15.385378-1.961554 0.075861-3.923109-0.019868-5.806996-0.384724a20.616189 20.616189 0 0 0-3.271063-0.462393c-28.000014 0-65.616341 53.577888-74.768455 125.268545-6.000261 47.40423 1.84415 91.75053 20.07613 112.941097 8.537999 9.943238 15.808033 10.116635 18.192242 10.174434 2.035609 0 24.11303 0.691782 38.960154 19.017685 11.344864 13.981945 14.615928 32.9039 9.807771 56.251092a24.541104 24.541104 0 0 1-1.192104 4.020645c-12.769972 31.769594-28.000014 63.345923-45.229542 93.807814-18.772039 33.229019-39.924675 65.03835-62.847406 94.539333a22.772815 22.772815 0 0 1-3.383049 3.538384c-11.155211 11.364733-24.924022 17.346932-40.000536 17.346932-23.961307-0.019868-42.538275-15.481107-44.53776-17.271071a23.661475 23.661475 0 0 1-4.575154-5.306673c-5.539675-8.882987-17.657601-10.748812-26.811522-10.748812z"
              p-id="9579"
            />
          </svg>
          <p>客服</p>
        </div>
        <van-popup v-model="show1" class="popupBox" :closeable="true">
          <div class="title">联系客服</div>
          <div class="svgBox">
            <svg
              t="1574388078348"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="6646"
              width="82"
              height="82"
            >
              <path
                d="M951.296 454.656v-6.144C951.296 211.968 754.688 20.48 513.024 20.48 271.36 20.48 74.752 211.968 74.752 447.488v6.144C32.768 468.992 2.048 507.904 2.048 553.984V696.32c0 59.392 55.296 106.496 115.712 106.496S237.568 754.688 237.568 696.32V555.008c0-46.08-36.864-84.992-78.848-100.352v-6.144c0-160.768 153.6-331.776 355.328-331.776 201.728 0 355.328 150.528 355.328 331.776v6.144c-41.984 15.36-80.896 54.272-80.896 100.352v142.336c0 59.392 54.272 106.496 114.688 106.496S1024 756.736 1024 697.344V555.008c0-46.08-30.72-86.016-72.704-100.352zM658.432 929.792v-32.768c0-19.456-16.384-35.84-36.864-35.84H476.16c-20.48 0-36.864 15.36-36.864 35.84v71.68c0 19.456 16.384 35.84 36.864 35.84h146.432c182.272 0 316.416-141.312 316.416-299.008l-60.416 14.336c-1.024 106.496-96.256 194.56-220.16 209.92z"
                fill="#C04374"
                p-id="6647"
              />
            </svg>
            <p class="phone_num">400-021-9988</p>
            <div data-v-bfba3668 class="t-button_wrap">
              <div data-v-38000290 data-v-bfba3668 class="t-button">立即拨打</div>
            </div>
          </div>
          <p class="des_txt">服务时间：周一至周日9:00-22:00</p>
        </van-popup>
      </div>
      <div class="action">查看团期</div>
    </div>
  </div>
</template>

<script>
import { get } from "utils/http.js";
import store from "@/store";
export default {
  data() {
    return {
      id: "",
      list: [],
      show: false,
      show1: false,
      midBox: false
    };
  },
  async mounted() {
    this.id = this.$route.params.keyword;
    let result = await get({
      url: "/api/v3/m1/product/detail",
      params: {
        product_id: this.id,
        platform: 4
      }
    });
    this.list = result.data;
    for (let i = 0; i < store.state.collect.length; i++) {
      if (store.state.collect[i].id == this.id) {
        this.show = true;
      }
    }
  },
  methods: {
    collectInfo() {
      this.show = !this.show;
      let id = this.list.id;
      let name = this.list.title;
      let price = this.list.min_price;
      let img = this.list.product_img_www[0].url;
      if (this.show) {
        // console.log('红');
        store.commit("collectInfoAdd", [id, name, price, img]);
      } else {
        for (let i = 0; i < store.state.collect.length; i++) {
          // console.log('灰 遍历');
          if (store.state.collect[i].id == this.id) {
            // console.log('删除');
            store.commit("collectInfoMinus", i);
            this.midBox = true
          }
        }
        if(this.midBox == false){
          
        }
      }
    },
    showPopup() {
      this.show1 = true;
    }
  }
};
</script>

<style lang="stylus" scoped>
.popupBox
  width 2.95rem
  height 4.16rem
  padding 0.2rem 0.2rem 0.3rem !important
  .title
    font-size 0.16rem
    color #333
    font-weight 600
    text-align left!important
  svg
    margin 0.43rem 0 0.13rem
  .svgBox
    text-align center
  .phone_num
    margin-bottom 0.5rem
    font-size 0.32rem!important
    color #C04374
    text-align center
    // letter-spacing 2px
  .t-button_wrap
    margin-bottom 0.2rem
  .t-button
    color #fff
    font-size 0.15rem
    width 100%
    height 0.4rem
    background #C04374
    line-height 0.4rem
    text-align center
  .des_txt
    font-size 0.12rem
    text-align center
.Fatherbox
  height 100%
  display flex
  flex-direction column
.main
  overflow-y scroll
  height 100%
  flex 1
.footer
  height 0.54rem
  background #fff
  padding 0.04rem 0.18rem 0.05rem
  display flex
  justify-content space-between
  .content
    display flex
    justify-content space-between
    padding-right 0.15rem
    padding-left 0.15rem
    flex 1
    div
      text-align center
      padding-top 0.03rem
      p
        font-family 'Microsoft YaHei'
        font-size 0.12rem
        font-weight 500 !important
  .action
    width 2.24rem
    height 0.45rem
    background #C04374
    border-radius 0.03rem
    text-align center
    line-height 0.45rem
    font-size 0.15rem
    color #FFFFFF
    font-family PingFangSC-Regular
</style>